var tz_aliases={Afghanistan:"Asia/Kabul","Aland Islands":"Europe/Mariehamn",Albania:"Europe/Tirane",Algeria:"Africa/Algiers","American Samoa":"Pacific/Pago_Pago",Andorra:"Europe/Andorra",Angola:"Africa/Luanda",Anguilla:"America/Anguilla","Antigua and Barbuda":"America/Antigua",Armenia:"Asia/Yerevan",Aruba:"America/Aruba",Austria:"Europe/Vienna",Azerbaijan:"Asia/Baku",Bahamas:"America/Nassau",Bahrain:"Asia/Bahrain",Bangladesh:"Asia/Dhaka",Barbados:"America/Barbados",Belarus:"Europe/Minsk",Belgium:"Europe/Brussels",Belize:"America/Belize",Benin:"Africa/Porto-Novo",Bermuda:"Atlantic/Bermuda",Bhutan:"Asia/Thimphu",Bolivia:"America/La_Paz","Bonaire, Saint Eustatius and Saba":"America/Kralendijk","Bosnia and Herzegovina":"Europe/Sarajevo",Botswana:"Africa/Gaborone","British Indian Ocean Territory":"Indian/Chagos","British Virgin Islands":"America/Tortola",Brunei:"Asia/Brunei",Bulgaria:"Europe/Sofia","Burkina Faso":"Africa/Ouagadougou",Burundi:"Africa/Bujumbura",Cambodia:"Asia/Phnom_Penh",Cameroon:"Africa/Douala","Cape Verde":"Atlantic/Cape_Verde","Cayman Islands":"America/Cayman","Central African Republic":"Africa/Bangui",Chad:"Africa/Ndjamena","Christmas Island":"Indian/Christmas","Cocos Islands":"Indian/Cocos",Colombia:"America/Bogota",Comoros:"Indian/Comoro","Cook Islands":"Pacific/Rarotonga","Costa Rica":"America/Costa_Rica",Croatia:"Europe/Zagreb",Cuba:"America/Havana","Curaçao":"America/Curacao",Cyprus:"Asia/Nicosia","Czech Republic":"Europe/Prague",Denmark:"Europe/Copenhagen",Djibouti:"Africa/Djibouti",Dominica:"America/Dominica","Dominican Republic":"America/Santo_Domingo","East Timor":"Asia/Dili",Egypt:"Africa/Cairo","El Salvador":"America/El_Salvador","Equatorial Guinea":"Africa/Malabo",Eritrea:"Africa/Asmara",Estonia:"Europe/Tallinn",Ethiopia:"Africa/Addis_Ababa","Falkland Islands":"Atlantic/Stanley","Faroe Islands":"Atlantic/Faroe",Fiji:"Pacific/Fiji",Finland:"Europe/Helsinki",France:"Europe/Paris","French Guiana":"America/Cayenne","French Southern Territories":"Indian/Kerguelen",Gabon:"Africa/Libreville",Gambia:"Africa/Banjul",Georgia:"Asia/Tbilisi",Ghana:"Africa/Accra",Gibraltar:"Europe/Gibraltar",Greece:"Europe/Athens",Grenada:"America/Grenada",Guadeloupe:"America/Guadeloupe",Guam:"Pacific/Guam",Guatemala:"America/Guatemala",Guernsey:"Europe/Guernsey",Guinea:"Africa/Conakry","Guinea-Bissau":"Africa/Bissau",Guyana:"America/Guyana",Haiti:"America/Port-au-Prince",Honduras:"America/Tegucigalpa","Hong Kong":"Asia/Hong_Kong",Hungary:"Europe/Budapest",Iceland:"Atlantic/Reykjavik",India:"Asia/Kolkata",Iran:"Asia/Tehran",Iraq:"Asia/Baghdad",Ireland:"Europe/Dublin","Isle of Man":"Europe/Isle_of_Man",Israel:"Asia/Jerusalem",Italy:"Europe/Rome","Ivory Coast":"Africa/Abidjan",Jamaica:"America/Jamaica",Japan:"Asia/Tokyo",Jersey:"Europe/Jersey",Jordan:"Asia/Amman",Kenya:"Africa/Nairobi",Kuwait:"Asia/Kuwait",Kyrgyzstan:"Asia/Bishkek",Laos:"Asia/Vientiane",Latvia:"Europe/Riga",Lebanon:"Asia/Beirut",Lesotho:"Africa/Maseru",Liberia:"Africa/Monrovia",Libya:"Africa/Tripoli",Liechtenstein:"Europe/Vaduz",Lithuania:"Europe/Vilnius",Luxembourg:"Europe/Luxembourg",Macao:"Asia/Macau",Macedonia:"Europe/Skopje",Madagascar:"Indian/Antananarivo",Malawi:"Africa/Blantyre",Maldives:"Indian/Maldives",Mali:"Africa/Bamako",Malta:"Europe/Malta",Martinique:"America/Martinique",Mauritania:"Africa/Nouakchott",Mauritius:"Indian/Mauritius",Mayotte:"Indian/Mayotte",Moldova:"Europe/Chisinau",Monaco:"Europe/Monaco",Montenegro:"Europe/Podgorica",Montserrat:"America/Montserrat",Morocco:"Africa/Casablanca",Mozambique:"Africa/Maputo",Myanmar:"Asia/Rangoon",Namibia:"Africa/Windhoek",Nauru:"Pacific/Nauru",Nepal:"Asia/Kathmandu",Netherlands:"Europe/Amsterdam","New Caledonia":"Pacific/Noumea",Nicaragua:"America/Managua",Niger:"Africa/Niamey",Nigeria:"Africa/Lagos",Niue:"Pacific/Niue","Norfolk Island":"Pacific/Norfolk","North Korea":"Asia/Pyongyang","Northern Mariana Islands":"Pacific/Saipan",Norway:"Europe/Oslo",Oman:"Asia/Muscat",Pakistan:"Asia/Karachi",Palau:"Pacific/Palau",Panama:"America/Panama",Paraguay:"America/Asuncion",Peru:"America/Lima",Philippines:"Asia/Manila",Pitcairn:"Pacific/Pitcairn",Poland:"Europe/Warsaw","Puerto Rico":"America/Puerto_Rico",Qatar:"Asia/Qatar","Republic of the Congo":"Africa/Brazzaville",Reunion:"Indian/Reunion",Romania:"Europe/Bucharest",Rwanda:"Africa/Kigali","Saint Barthélemy":"America/St_Barthelemy","Saint Helena":"Atlantic/St_Helena","Saint Kitts and Nevis":"America/St_Kitts","Saint Lucia":"America/St_Lucia","Saint Martin":"America/Marigot","Saint Pierre and Miquelon":"America/Miquelon","Saint Vincent and the Grenadines":"America/St_Vincent",Samoa:"Pacific/Apia","San Marino":"Europe/San_Marino","Sao Tome and Principe":"Africa/Sao_Tome","Saudi Arabia":"Asia/Riyadh",Senegal:"Africa/Dakar",Serbia:"Europe/Belgrade",Seychelles:"Indian/Mahe","Sierra Leone":"Africa/Freetown",Singapore:"Asia/Singapore","Sint Maarten":"America/Lower_Princes",Slovakia:"Europe/Bratislava",Slovenia:"Europe/Ljubljana","Solomon Islands":"Pacific/Guadalcanal",Somalia:"Africa/Mogadishu","South Africa":"Africa/Johannesburg","South Georgia and the South Sandwich Islands":"Atlantic/South_Georgia","South Korea":"Asia/Seoul","South Sudan":"Africa/Juba","Sri Lanka":"Asia/Colombo",Sudan:"Africa/Khartoum",Suriname:"America/Paramaribo","Svalbard and Jan Mayen":"Arctic/Longyearbyen",Swaziland:"Africa/Mbabane",Sweden:"Europe/Stockholm",Switzerland:"Europe/Zurich",Syria:"Asia/Damascus",Taiwan:"Asia/Taipei",Tajikistan:"Asia/Dushanbe",Tanzania:"Africa/Dar_es_Salaam",Thailand:"Asia/Bangkok",Togo:"Africa/Lome",Tokelau:"Pacific/Fakaofo",Tonga:"Pacific/Tongatapu","Trinidad and Tobago":"America/Port_of_Spain",Tunisia:"Africa/Tunis",Turkey:"Europe/Istanbul",Turkmenistan:"Asia/Ashgabat","Turks and Caicos Islands":"America/Grand_Turk",Tuvalu:"Pacific/Funafuti","U.S. Virgin Islands":"America/St_Thomas",Uganda:"Africa/Kampala","United Arab Emirates":"Asia/Dubai","United Kingdom":"Europe/London",UK:"Europe/London",GB:"Europe/London","Great Britain":"Europe/London",Uruguay:"America/Montevideo",Vanuatu:"Pacific/Efate",Vatican:"Europe/Vatican",Venezuela:"America/Caracas",Vietnam:"Asia/Ho_Chi_Minh","Wallis and Futuna":"Pacific/Wallis","Western Sahara":"Africa/El_Aaiun",Yemen:"Asia/Aden",Zambia:"Africa/Lusaka",Zimbabwe:"Africa/Harare",Germany:"Europe/Berlin",Busingen:"Europe/Busingen","Germany, Busingen":"Europe/Busingen",Galapagos:"Pacific/Galapagos",Ecuador:"America/Guayaquil",Chile:"America/Santiago","Easter Island":"Pacific/Easter",Spain:"Europe/Madrid",Portugal:"Europe/Lisbon",Madeira:"Atlantic/Madeira",Azores:"Atlantic/Azores",Ceuta:"Africa/Ceuta",Canary:"Atlantic/Canary","Antarctica, McMurdo":"Antarctica/McMurdo","Antarctica, Rothera":"Antarctica/Rothera","Antarctica, Palmer":"Antarctica/Palmer","Antarctica, Mawson":"Antarctica/Mawson","Antarctica, Davis":"Antarctica/Davis","Antarctica, Casey":"Antarctica/Casey","Antarctica, Vostok":"Antarctica/Vostok","Antarctica, DumontDUrville":"Antarctica/DumontDUrville","Antarctica, Syowa":"Antarctica/Syowa","Antarctica, Troll":"Antarctica/Troll","Antarctica, Macquarie":"Antarctica/Macquarie","Argentina, Buenos Aires":"America/Argentina/Buenos_Aires","Argentina, Cordoba":"America/Argentina/Cordoba","Argentina, Salta":"America/Argentina/Salta","Argentina, Jujuy":"America/Argentina/Jujuy","Argentina, Tucuman":"America/Argentina/Tucuman","Argentina, Catamarca":"America/Argentina/Catamarca","Argentina, La Rioja":"America/Argentina/La_Rioja","Argentina, San Juan":"America/Argentina/San_Juan","Argentina, Mendoza":"America/Argentina/Mendoza","Argentina, San Luis":"America/Argentina/San_Luis","Argentina, Rio Gallegos":"America/Argentina/Rio_Gallegos","Argentina, Ushuaia":"America/Argentina/Ushuaia","Australia, Lord Howe":"Australia/Lord_Howe","Australia, Hobart":"Australia/Hobart","Australia, Currie":"Australia/Currie","Australia, Melbourne":"Australia/Melbourne","Australia, Sydney":"Australia/Sydney","Australia, Broken Hill":"Australia/Broken_Hill","Australia, Brisbane":"Australia/Brisbane","Australia, Lindeman":"Australia/Lindeman","Australia, Adelaide":"Australia/Adelaide","Australia, Darwin":"Australia/Darwin","Australia, Perth":"Australia/Perth","Australia, Eucla":"Australia/Eucla","Brazil, Noronha":"America/Noronha","Brazil, Belem":"America/Belem","Brazil, Fortaleza":"America/Fortaleza","Brazil, Recife":"America/Recife","Brazil, Araguaina":"America/Araguaina","Brazil, Maceio":"America/Maceio","Brazil, Bahia":"America/Bahia","Brazil, Sao Paulo":"America/Sao_Paulo","Brazil, Campo Grande":"America/Campo_Grande","Brazil, Cuiaba":"America/Cuiaba","Brazil, Santarem":"America/Santarem","Brazil, Porto Velho":"America/Porto_Velho","Brazil, Boa Vista":"America/Boa_Vista","Brazil, Manaus":"America/Manaus","Brazil, Eirunepe":"America/Eirunepe","Brazil, Rio Branco":"America/Rio_Branco","Canada, St_Johns":"America/St_Johns","Canada, Halifax":"America/Halifax","Canada, Glace Bay":"America/Glace_Bay","Canada, Moncton":"America/Moncton","Canada, Goose Bay":"America/Goose_Bay","Canada, Blanc-Sablon":"America/Blanc-Sablon","Canada, Toronto":"America/Toronto","Canada, Nipigon":"America/Nipigon","Canada, Thunder Bay":"America/Thunder_Bay","Canada, Iqaluit":"America/Iqaluit","Canada, Pangnirtung":"America/Pangnirtung","Canada, Resolute":"America/Resolute","Canada, Atikokan":"America/Atikokan","Canada, Rankin Inlet":"America/Rankin_Inlet","Canada, Winnipeg":"America/Winnipeg","Canada, Rainy River":"America/Rainy_River","Canada, Regina":"America/Regina","Canada, Swift Current":"America/Swift_Current","Canada, Edmonton":"America/Edmonton","Canada, Cambridge Bay":"America/Cambridge_Bay","Canada, Yellowknife":"America/Yellowknife","Canada, Inuvik":"America/Inuvik","Canada, Creston":"America/Creston","Canada, Dawson Creek":"America/Dawson_Creek","Canada, Vancouver":"America/Vancouver","Canada, Whitehorse":"America/Whitehorse","Canada, Dawson":"America/Dawson","China, Shanghai":"Asia/Shanghai","China, Urumqi":"Asia/Urumqi","Congo, Kinshasa":"Africa/Kinshasa","Congo, Lubumbashi":"Africa/Lubumbashi","French Polynesia, Tahiti":"Pacific/Tahiti","French Polynesia, Marquesas":"Pacific/Marquesas","French Polynesia, Gambier":"Pacific/Gambier","Greenland, Godthab":"America/Godthab","Greenland, Danmarkshavn":"America/Danmarkshavn","Greenland, Scoresbysund":"America/Scoresbysund","Greenland, Thule":"America/Thule","Indonesia, Jakarta":"Asia/Jakarta","Indonesia, Pontianak":"Asia/Pontianak","Indonesia, Makassar":"Asia/Makassar","Indonesia, Jayapura":"Asia/Jayapura","Kazakhstan, Almaty":"Asia/Almaty","Kazakhstan, Qyzylorda":"Asia/Qyzylorda","Kazakhstan, Aqtobe":"Asia/Aqtobe","Kazakhstan, Aqtau":"Asia/Aqtau","Kazakhstan, Oral":"Asia/Oral","Kiribati, Tarawa":"Pacific/Tarawa","Kiribati, Enderbury":"Pacific/Enderbury","Kiribati, Kiritimati":"Pacific/Kiritimati","Malaysia, Kuala Lumpur":"Asia/Kuala_Lumpur","Malaysia, Kuching":"Asia/Kuching","Marshall Islands, Majuro":"Pacific/Majuro","Marshall Islands, Kwajalein":"Pacific/Kwajalein",Mexico:"America/Mexico_City","Mexico, Mexico City":"America/Mexico_City","Mexico, Cancun":"America/Cancun","Mexico, Merida":"America/Merida","Mexico, Monterrey":"America/Monterrey","Mexico, Matamoros":"America/Matamoros","Mexico, Mazatlan":"America/Mazatlan","Mexico, Chihuahua":"America/Chihuahua","Mexico, Ojinaga":"America/Ojinaga","Mexico, Hermosillo":"America/Hermosillo","Mexico, Tijuana":"America/Tijuana","Mexico, Santa Isabel":"America/Santa_Isabel","Mexico, Bahia Banderas":"America/Bahia_Banderas","Micronesia, Chuuk":"Pacific/Chuuk","Micronesia, Pohnpei":"Pacific/Pohnpei","Micronesia, Kosrae":"Pacific/Kosrae","Mongolia, Ulaanbaatar":"Asia/Ulaanbaatar","Mongolia, Hovd":"Asia/Hovd","Mongolia, Choibalsan":"Asia/Choibalsan","New Zealand, Auckland":"Pacific/Auckland","New Zealand, Chatham":"Pacific/Chatham","Palestina, Gaza":"Asia/Gaza","Palestina, Hebron":"Asia/Hebron","Papua New Guinea, Port_Moresby":"Pacific/Port_Moresby","Papua New Guinea, Bougainville":"Pacific/Bougainville","Russia, Kaliningrad":"Europe/Kaliningrad","Russia, Moscow":"Europe/Moscow","Russia, Simferopol":"Europe/Simferopol","Russia, Volgograd":"Europe/Volgograd","Russia, Samara":"Europe/Samara","Russia, Yekaterinburg":"Asia/Yekaterinburg","Russia, Omsk":"Asia/Omsk","Russia, Novosibirsk":"Asia/Novosibirsk","Russia, Novokuznetsk":"Asia/Novokuznetsk","Russia, Krasnoyarsk":"Asia/Krasnoyarsk","Russia, Irkutsk":"Asia/Irkutsk","Russia, Chita":"Asia/Chita","Russia, Yakutsk":"Asia/Yakutsk","Russia, Khandyga":"Asia/Khandyga","Russia, Vladivostok":"Asia/Vladivostok","Russia, Sakhalin":"Asia/Sakhalin","Russia, Ust-Nera":"Asia/Ust-Nera","Russia, Magadan":"Asia/Magadan","Russia, Srednekolymsk":"Asia/Srednekolymsk","Russia, Kamchatka":"Asia/Kamchatka","Russia, Anadyr":"Asia/Anadyr","Ukraine, Kiev":"Europe/Kiev","Ukraine, Uzhgorod":"Europe/Uzhgorod","Ukraine, Zaporozhye":"Europe/Zaporozhye","Uzbekistan, Samarkand":"Asia/Samarkand","Uzbekistan, Tashkent":"Asia/Tashkent","United States, New York":"America/New_York","United States, Michigan - Detroit":"America/Detroit","United States, Michigan - Menominee":"America/Menominee","United States, Kentucky - Louisville":"America/Kentucky/Louisville","United States, Kentucky - Monticello":"America/Kentucky/Monticello","United States, Indiana - Indianapolis":"America/Indiana/Indianapolis","United States, Indiana - Vincennes":"America/Indiana/Vincennes","United States, Indiana - Winamac":"America/Indiana/Winamac","United States, Indiana - Marengo":"America/Indiana/Marengo","United States, Indiana - Petersburg":"America/Indiana/Petersburg","United States, Indiana - Vevay":"America/Indiana/Vevay","United States, Indiana - Tell City":"America/Indiana/Tell_City","United States, Indiana - Knox":"America/Indiana/Knox","United States, Illinois":"America/Chicago","United States, North Dakota - Center":"America/North_Dakota/Center","United States, North Dakota - New Salem":"America/North_Dakota/New_Salem","United States, North Dakota - Beulah":"America/North_Dakota/Beulah","United States, Colorado":"America/Denver","United States, Idaho":"America/Boise","United States, Arizona":"America/Phoenix","United States, California":"America/Los_Angeles","United States, Alaska - Metlakatla":"America/Metlakatla","United States, Alaska - Anchorage":"America/Anchorage","United States, Alaska - Juneau":"America/Juneau","United States, Alaska - Sitka":"America/Sitka","United States, Alaska - Yakutat":"America/Yakutat","United States, Alaska - Nome":"America/Nome","United States, Alaska - Adak":"America/Adak","United States, Hawaii":"Pacific/Honolulu","USA, New York":"America/New_York","USA, Michigan - Detroit":"America/Detroit","USA, Michigan - Menominee":"America/Menominee","USA, Kentucky - Louisville":"America/Kentucky/Louisville","USA, Kentucky - Monticello":"America/Kentucky/Monticello","USA, Indiana - Indianapolis":"America/Indiana/Indianapolis","USA, Indiana - Vincennes":"America/Indiana/Vincennes","USA, Indiana - Winamac":"America/Indiana/Winamac","USA, Indiana - Marengo":"America/Indiana/Marengo","USA, Indiana - Petersburg":"America/Indiana/Petersburg","USA, Indiana - Vevay":"America/Indiana/Vevay","USA, Indiana - Tell City":"America/Indiana/Tell_City","USA, Indiana - Knox":"America/Indiana/Knox","USA, Illinois":"America/Chicago","USA, North Dakota - Center":"America/North_Dakota/Center","USA, North Dakota - New Salem":"America/North_Dakota/New_Salem","USA, North Dakota - Beulah":"America/North_Dakota/Beulah","USA, Colorado":"America/Denver","USA, Idaho":"America/Boise","USA, Arizona":"America/Phoenix","USA, California":"America/Los_Angeles","USA, Alaska - Metlakatla":"America/Metlakatla","USA, Alaska - Anchorage":"America/Anchorage","USA, Alaska - Juneau":"America/Juneau","USA, Alaska - Sitka":"America/Sitka","USA, Alaska - Yakutat":"America/Yakutat","USA, Alaska - Nome":"America/Nome","USA, Alaska - Adak":"America/Adak","USA, Hawaii":"Pacific/Honolulu",Hawaii:"Pacific/Honolulu","USA, Eastern Time":"America/New_York","USA, Central Time":"America/Chicago","USA, Mountain Time":"America/Denver","USA, Pacific Time":"America/Los_Angeles",GMT:"Africa/Dakar",UTC:"Africa/Dakar",CET:"Europe/Berlin",CEST:"Europe/Berlin"};var Ajax;(function(b){function a(d,f,c){var e=new XMLHttpRequest();e.open("GET",d,true);e.timeout=3000;e.onreadystatechange=function(){if(e.readyState==4){if(e.status>=200&&e.status<400){if(typeof f=="function"){f(e.responseText)}}else{if(typeof c=="function"){c(e.status)}}}};e.onerror=function(){if(typeof c=="function"){c(-1)}};e.send()}b.get=a})(Ajax||(Ajax={}));var Tzork;(function(a){var b;(function(f){var m=0;var d=null;function c(p){if(d==null){var n=localStorage.tz_cache;if(n){try{d=JSON.parse(n);if(d===null){d={}}}catch(o){d={}}}else{d={}}}return Utils.objGet(d,p,null)}function k(o,n){d[o]=n;localStorage.tz_cache=JSON.stringify(d)}function j(o,p){o.forEach(function(q){q._valid=true;var r=false;["name","color","tz"].forEach(function(s){if(!Utils.keyExists(q,s)){console.error('Missing "'+s+'" field in point object',q);r=true}});if(r){q._valid=false;return}Utils.setIfMissing(q,"show",true);m++;e(q)});(function n(){if(m<=0){p();return}setTimeout(n,5)})()}f.resolvePointTimezones=j;function e(n){n._tz=n.tz;if(n.tz in tz_aliases){n._tz=tz_aliases[n.tz];console.log('TZ "'+n.tz+'" resolved as "'+n._tz+'"')}var o=c(n.tz);if(o){n._tz=o}if(moment.tz.zone(n._tz)){m--;return}g(n)}var h=0;function g(p){var n=(Date.now()-h);var o=Math.max(0,(105-n));if(o==0){h=Date.now();l(p);return}setTimeout(function(){g(p)},o)}function l(r){var p="https://maps.googleapis.com/maps/api/geocode/json?sensor=false&address="+encodeURIComponent(r.tz);function o(s){console.log("FAIL: code "+s);r._valid=false;m--}function q(y){try{var t=JSON.parse(y);console.log("Reply from geoAPI:",t);if(t.status!=="OK"){r._valid=false;m--;return}var v=t.results;if(v.length>1){console.error('WARNING: Google found multiple matches. Try to be more specific at "'+r.tz+'"')}var x=v[0].geometry.location;var u=Math.floor(Date.now()/1000);var s="https://maps.googleapis.com/maps/api/timezone/json?location="+x.lat+","+x.lng+"&timestamp="+u+"&sensor=false";Ajax.get(s,n,o)}catch(w){console.log(w);r._valid=false;m--}}function n(u){try{var s=JSON.parse(u);console.log("Reply from Google:",s);if(s.status!=="OK"){r._valid=false;m--;return}console.log("Resolved TZ as "+s.timeZoneId);r._tz=s.timeZoneId;k(r.tz,r._tz);m--}catch(t){console.log(t);r._valid=false;m--}}Ajax.get(p,q,o)}function i(o){var n=moment().tz(o._tz);return n.hour()*3600+n.minute()*60+n.second()}f.getTimeForPoint=i})(b=a.TzResolver||(a.TzResolver={}))})(Tzork||(Tzork={}));if(!Date.now){Date.now=function(){return new Date().getTime()}}var Utils;(function(l){function i(s,q,r){return Math.max(q,Math.min(r,s))}l.clamp=i;function a(r){var q=(18-r)*15;while(q<0){q+=360}return q}l.hour2angle=a;function b(q,t,v,r){if(r===void 0){r=0}var s=(v*Math.cos((t/180)*Math.PI));var u=(v*Math.sin((t/180)*Math.PI));switch(r){case 0:case 1:case 7:q.style.left=(50+s)+"%";q.style.top=(50-u)+"%";break;case 2:case 3:case 4:q.style.right=(50-s)+"%";q.style.top=(50-u)+"%";break;case 5:q.style.right=(50-s)+"%";q.style.bottom=(50+u)+"%";break;case 6:q.style.left=(50+s)+"%";q.style.bottom=(50+u)+"%";break}}l.positionAt=b;function o(r,v,x,q,t,s){if(s===void 0){s=0}var u=(x*Math.cos((v/180)*Math.PI));var w=(x*Math.sin((v/180)*Math.PI));switch(s){case 0:case 1:case 7:r.style.left=Math.round(q/2+u+t)+"px";r.style.top=Math.round(q/2-w+t)+"px";break;case 2:case 3:case 4:r.style.right=Math.round(q/2-u+t)+"px";r.style.top=Math.round(q/2-w+t)+"px";break;case 5:r.style.right=Math.round(q/2-u+t)+"px";r.style.bottom=Math.round(q/2+w+t)+"px";break;case 6:r.style.left=Math.round(q/2+u+t)+"px";r.style.bottom=Math.round(q/2+w+t)+"px";break}}l.positionAtPx=o;function g(q,u){var v=q.dayOfYear();var s=q.year();var t=u.dayOfYear();var r=u.year();if(r<s){return -1}else{if(r>s){return 1}else{if(t<v){return -1}else{if(t>v){return 1}}}}return 0}l.mmtDayCompare=g;function h(s,r){var u=document.querySelectorAll(s);for(var q=0;q<u.length;q++){var t=u[q];r(t)}}l.iterateQuery=h;function e(q){return document.querySelector(q)}l.queryOne=e;function f(s,q,r){if(!n(s,q)){s[q]=r}}l.setIfMissing=f;function n(q,r){return typeof(q[r])!="undefined"}l.keyExists=n;function c(s,q,r){if(!n(s,q)){return r}return s[q]}l.objGet=c;function p(){var q=document.getElementsByTagName("textarea");var s=q.length;for(var r=0;r<s;r++){q[r].onkeydown=function(u){if(u.keyCode==9||u.which==9){u.preventDefault();var t=this.selectionStart;this.value=this.value.substring(0,this.selectionStart)+"\t"+this.value.substring(this.selectionEnd);this.selectionEnd=t+1}}}}l.fixTextareaTabKey=p;function k(s,u){var t=false;var q;$(s).on("mouseover",function(){$(u).removeClass("gone");t=true;clearTimeout(q)});$(u).on("mouseover",function(){clearTimeout(q)});function r(){q=setTimeout(function(){$(u).addClass("gone");t=false},10)}$(u).on("mouseout",r);$(s).on("mouseout",r)}l.hoverMenu=k;function d(q,u,v){q/=255;u/=255;v/=255;var y=Math.min(q,u,v),A=Math.max(q,u,v),x=A-y,z={h:0,s:0,b:A},w,s,t;if(x!==0){z.s=x/A;w=(((A-q)/6)+(x/2))/x;s=(((A-u)/6)+(x/2))/x;t=(((A-v)/6)+(x/2))/x;if(q===A){z.h=t-s}else{if(u===A){z.h=(1/3)+w-t}else{if(v===A){z.h=(2/3)+s-w}}}if(z.h<0){z.h+=1}if(z.h>1){z.h-=1}}z.h*=360;z.s*=100;z.b*=100;return z}l.rgb2hsb=d;function j(t,s,q){return(((t*299)+(s*587)+(q*114))/1000)<128}l.isColorDark=j;function m(t,r){var s=document.getElementById(t);if(s){s.parentElement.removeChild(s)}var q=document.createElement("style");q.type="text/css";q.innerHTML=r;q.id=t;document.head.appendChild(q)}l.applyStylesheet=m})(Utils||(Utils={}));var tz_def_profile={title:"My Tzork",showTitle:true,innerImage:"images/bg-earth.jpg",innerColor:"",outerImage:"",outerColor:"",fgColor:"",labelShadows:true,labelHoverBg:"",menuColor:"",points:[{name:"@MightyPork",tz:"Czech Republic",color:"#FFAD00",show:true},{name:"@AntonvonRaumer",tz:"Germany",color:"#FF8585",show:true},{name:"@ciba43",tz:"Latvia",color:"#FE2F77",show:true},{name:"@coolsquid_",tz:"Norway",color:"#079DE9",show:true},{name:"@Creeper32605",tz:"Denmark",color:"#C8F080",show:true},{name:"@Deli731234",tz:"USA, Pacific Time",color:"#A659E2",show:true},{name:"@eevblog",tz:"Australia, Sydney",color:"#E63E3F",show:true},{name:"@elakdawalla",tz:"USA, Pacific Time",color:"#C49B6D",show:true},{name:"@iamSethD",tz:"USA, Eastern Time",color:"#ED2222",show:true},{name:"@ImReble548",tz:"USA, Mountain Time",color:"#69E79E",show:true},{name:"@Jaredlll08",tz:"South Africa",color:"#F86752",show:true},{name:"@JesperJacoben",tz:"Denmark",color:"skyblue",show:true},{name:"@lastofavari",tz:"Belarus",color:"#05CDC0",show:true},{name:"@ljfa2",tz:"Germany",color:"#78FCFF",show:true},{name:"@Locercus",tz:"Denmark",color:"#32CD32",show:true},{name:"@Lunatrius",tz:"Slovenia",color:"#00CCFF",show:true},{name:"@Rafmaninoff",tz:"Spain",color:"#00CC00",show:true},{name:"@TheBadFame",tz:"Mexico",color:"#329AFF",show:true},{name:"@Vangoule273",tz:"United Kingdom",color:"#00FF2C",show:true},{name:"@xTordX",tz:"Romania",color:"#AE1AF7",show:true}]};var Tzork;(function(a){var b;(function(e){function g(i){i=JSON.parse(JSON.stringify(i));delete i._valid;i.points.forEach(function(j){delete j._t;delete j._tz;delete j._valid});return i}e.stripProfile=g;function d(){return{title:"Tzork Profile",showTitle:true,innerImage:"images/bg-earth.jpg",innerColor:"",outerImage:"",outerColor:"#0B1A2E",fgColor:"",labelShadows:true,labelHoverBg:"",menuColor:"",points:[{name:"@MightyPork",tz:"Europe/Prague",color:"orange",show:true}]}}e.createEmptyProfile=d;function f(){return JSON.parse(JSON.stringify(tz_def_profile))}e.createDefaultProfile=f;var c=(function(){function i(){this.profiles=[];this.activeProfile=0}i.prototype.getActiveProfile=function(){return this.profiles[this.activeProfile]};i.prototype.load=function(n){try{var l=localStorage.repository;if(l!=null){var k=JSON.parse(l);this.profiles=k.profiles||[];this.activeProfile=parseInt(k.active)}}catch(m){console.error("Error reading profiles from localStorage",m)}this.parse(n)};i.prototype.parse=function(o){var m=false;if(this.profiles.length==0){if(Utils.keyExists(localStorage,"people")){var l=f();l.points=JSON.parse(localStorage.people);this.profiles.push(l);delete localStorage.people}else{this.profiles.push(f())}m=true}this.activeProfile=Utils.clamp(this.activeProfile,0,this.profiles.length-1);var n=0;this.profiles.forEach(function(q){Utils.setIfMissing(q,"points",[]);Utils.setIfMissing(q,"showTitle",true);Utils.setIfMissing(q,"innerImage","");Utils.setIfMissing(q,"innerColor","");Utils.setIfMissing(q,"outerImage","");Utils.setIfMissing(q,"outerColor","");Utils.setIfMissing(q,"fgColor","");Utils.setIfMissing(q,"labelShadows",true);Utils.setIfMissing(q,"labelHoverBg","");Utils.setIfMissing(q,"menuColor","");n++;a.TzResolver.resolvePointTimezones(q.points,function(){n--})});var k=this;(function j(){if(n==0){if(m){k.store()}(typeof o=="function")&&o()}else{setTimeout(j,5)}})()};i.prototype.store=function(k){var j=[];this.profiles.forEach(function(l){j.push(g(l))});localStorage.repository=JSON.stringify({profiles:j,active:this.activeProfile});(typeof k=="function")&&k()};return i})();e.LocalRepository=c;var h=(function(){function i(){this.local=null}i.prototype._read=function(){if(!this.local){try{var l=localStorage.config;var k=JSON.parse(l);this.local=k||{}}catch(m){this.local={}}}};i.prototype.get=function(k,j){this._read();return Utils.objGet(this.local,k,j)};i.prototype.set=function(j,k){this._read();this.local[j]=k;localStorage.config=JSON.stringify(this.local)};i.prototype.setIfMissing=function(j,k){if(!Utils.keyExists(this.local,j)){this.set(j,k)}};return i})();e.LocalConfigProvider=h})(b=a.Data||(a.Data={}))})(Tzork||(Tzork={}));var RGBColor=(function(){function a(g){this.ok=false;if(g.charAt(0)=="#"){g=g.substr(1,6)}g=g.replace(/ /g,"");g=g.toLowerCase();if(a.simple_colors.hasOwnProperty(g)){g=a.simple_colors[g]}var h=[{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(i){return[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(i){return[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]}},{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*(?:[\d.]+)\)$/,process:function(i){return[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(i){return[parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16)]}}];for(var c=0;c<h.length;c++){var e=h[c].re;var d=h[c].process;var f=e.exec(g);if(f){var b=d(f);this.r=b[0];this.g=b[1];this.b=b[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b)}a.prototype.toRGB=function(){return"rgb("+this.r+","+this.g+","+this.b+")"};a.prototype.toRGBA=function(b){return"rgba("+this.r+","+this.g+","+this.b+","+b+")"};a.prototype.toHex=function(){var e=this.r.toString(16);var d=this.g.toString(16);var c=this.b.toString(16);if(e.length==1){e="0"+e}if(d.length==1){d="0"+d}if(c.length==1){c="0"+c}return"#"+e+d+c};a.simple_colors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};return a})();var Tzork;(function(a){function b(){var i="";var h=a.theRepo.profiles[a.theRepo.activeProfile];var g,j;g=h.outerImage?'url("'+h.outerImage+'")':"none";j=h.outerColor||"#07151D";i+=".theme-outer {background-color: "+j+"; background-image: "+g+"}";var e,l;l=h.innerImage?'url("'+h.innerImage+'")':"none";e=h.innerColor||"transparent";i+=".theme-inner {background-color: "+e+"; background-image: "+l+"}";var f=h.fgColor||"#9cfff7";i+=".theme-fg {color: "+f+"}";if(!h.labelShadows){i+=".person-label {text-shadow: none}"}if(h.labelHoverBg){i+=".people-list:hover {background-color:"+h.labelHoverBg+"}"}var d=new RGBColor(f);var m=Utils.isColorDark(d.r,d.g,d.b);var d=new RGBColor(e);var k=Utils.isColorDark(d.r,d.g,d.b);var d=new RGBColor(j);var c=Utils.isColorDark(d.r,d.g,d.b);if(m){if(l=="none"&&g=="none"&&(e!="transparent"&&!k)&&(!c)){i+="#disc {box-shadow: none}"}else{i+="#disc {box-shadow: 0 0 3px 1px white, inset 0 0 3px 1px white}"}i+=".bullet {box-shadow: 0 0 4px white}";if(l=="none"&&((e!="transparent"&&!k)||(e=="transparent"&&(g=="none"&&!c)))){i+=".mark {text-shadow: none}";i+="#time-box {text-shadow: none}"}else{i+=".mark {text-shadow: 0 0 3px white, 0 0 6px white}";i+="#time-box {text-shadow: 0 0 8px white, 0 0 4px white}"}}if(h.menuColor){f=h.menuColor}d=new RGBColor(f);i+="#menubar {color: "+f+"}";i+=".profiles-menu a {background-color: "+d.toRGBA(0.1)+"}";i+=".profiles-menu a:hover {background-color: "+d.toRGBA(0.2)+"}";Utils.applyStylesheet("theme-styles",i)}a.applyThemeFromProfile=b})(Tzork||(Tzork={}));var Tzork;(function(a){var b=(function(){function c(){var e=this;this.disc=document.getElementById("disc");this._updateTime();this.interval_time=setInterval(this._updateTime,1000);var d=function(){var i=window.innerWidth;var l=window.innerHeight;var n=Math.round(Math.min(i,l))*1.2;var g=Math.round(n*0.0185);i-=g*19;l-=g*8;var k=Math.round(Math.min(i,l));if(k%2){k++}e.setDiskSize(k);var f=Math.round(k*0.025);if(f<8){f=8}var m=400;if(k>m){f=Math.round(m*0.025+(k-m)*0.015)}var j="#disc {font-size:"+f+"px}";if(k<250){j+=".mark {font-size:1.4em}.mark.sixth{font-size:1.8em}";j+="#time-box {font-size: .6em;}"}Utils.applyStylesheet("size-style",j)};window.onresize=d;d();this.loadActiveProfile()}c.prototype.setDiskSize=function(d){this.disc.style.width=d+"px";this.disc.style.height=d+"px";this.discSize=d;this.updatePoints();this._buildClockMarks()};c.prototype.loadActiveProfile=function(){this.clear();this._populate()};c.prototype._populate=function(){var f=this;var d=a.theRepo.getActiveProfile();console.log("Populate with profile: ",d);a.applyThemeFromProfile();var e=Utils.queryOne("#profile-label");e.textContent=d.title;e.style.display=d.showTitle?"block":"none";this.updatePoints();this.interval_people=setInterval(function(){f.updatePoints()},1000*10);window.onfocus=function(){f.updatePoints();f._updateTime()}};c.prototype.clear=function(){var d=document.querySelectorAll(".bullet, .person-label, .people-list");for(var e=0;e<d.length;e++){d[e].parentNode.removeChild(d[e])}clearInterval(this.interval_people)};c.prototype._buildClockMarks=function(){var d=document.querySelectorAll(".mark");for(var f=0;f<d.length;f++){d[f].parentNode.removeChild(d[f])}var l=a.theConfig.get("twelve",false);var g=parseInt(window.getComputedStyle(this.disc).borderRightWidth.replace("px",""));for(var f=0;f<24;f++){var k=document.createElement("div");k.classList.add("mark");k.classList.add("hour-"+f);if(f==0||f==6||f==12||f==18){k.classList.add("sixth")}if(l){var e=f;if(e>12){e-=12}k.textContent=""+e}else{k.textContent=""+f}var h=Utils.hour2angle(f);Utils.positionAtPx(k,h,(this.discSize/2)*0.88,this.discSize,-g);this.disc.appendChild(k)}};c.prototype._updateTime=function(){var f=moment();var d=f.format("H:mm");if(d!==this.last_time){this.last_time=d;var g=d.split(":");document.getElementById("local-time").innerHTML=g[0]+'<span id="local-time-colon">:</span>'+g[1]}var e=(new Date()).getSeconds()%2;document.getElementById("local-time-colon").style.visibility=e?"visible":"hidden"};c.prototype.updatePoints=function(){if(this.mouse_on_list){console.log("Mouse over list, not redrawing.");return}var d=document.querySelectorAll(".bullet, .person, .people-list");for(var f in d){if(d.hasOwnProperty(f)){var g=d[f];if(!g||!g.parentNode){continue}g.parentNode.removeChild(g)}}this._buildPoints()};c.prototype._buildPoints=function(){var f=this;var d=[];var e=a.theRepo.getActiveProfile();e.points.forEach(function(i){if(!i._valid||!i.show){return}var g=a.TzResolver.getTimeForPoint(i);i._t=g;var h;d.some(function(j){if(Math.abs(j.t-g)<60){j.p.push(i);h=true;return true}});if(!h){d.push({t:g,p:[i]})}});d.forEach(function(g){f._addPointsAtTime(g.t,g.p)})};c.prototype._addPointsAtTime=function(g,f){var q=this;var r;var j=f[0];var k=g/3600;var u=Utils.hour2angle(k);var o=Math.floor(u/45);var l=Math.floor(o/2);var y=(l<2);var p=(l>0&&l<3);var x=parseInt(window.getComputedStyle(this.disc).borderRightWidth.replace("px",""));var w=document.createElement("div");w.className="bullet";w.style.backgroundColor=j.color;Utils.positionAtPx(w,u,this.discSize/2-1,this.discSize,-x,0);this.disc.appendChild(w);var v=document.createElement("div");v.classList.add("people-list");v.classList.add(p?"left":"right");v.classList.add(y?"up":"down");v.classList.add("quad"+l);v.classList.add("oct"+o);var d=moment();var n=moment().tz(j._tz);r=Utils.mmtDayCompare(d,n);var z=(r==-1)?"day-prev":(r==1)?"day-next":null;if(z!==null){v.classList.add(z);w.classList.add(z)}if(f.length>1){v.classList.add("multiple");v.classList.add("count-"+f.length)}var e;for(r=0;r<f.length;r++){var m=f[r];var h=this._createPointLabel(m);h.title=n.format("H:mm, MMM Do")+" — "+m._tz;v.appendChild(h);if(r==0){e=h.style.color}}if(f.length>5&&o>=5){v.classList.add("forceGrowUp");o=6}v.style.borderColor=e;v.addEventListener("mouseover",function(){q.mouse_on_list=true});v.addEventListener("mouseout",function(){q.mouse_on_list=false});var s=(this.discSize/150)*5;Utils.positionAtPx(v,u,this.discSize/2+s,this.discSize,-x,o);this.disc.appendChild(v)};c.prototype._createPointLabel=function(e){var d;if(e.name.indexOf("@")===0){d=document.createElement("a");d.href="http://twitter.com/"+e.name;d.target="_blank"}else{d=document.createElement("span")}d.classList.add("person-label");d.style.color=e.color;d.textContent=e.name;return d};return c})();a.Clock=b})(Tzork||(Tzork={}));var Tzork;(function(a){var b;(function(c){function e(){Utils.hoverMenu("#menu-btn-profiles","#profiles-dropdown");document.getElementById("menu-btn-edit").addEventListener("click",function(){a.ProfileEditor.openDialog()});d();var f=document.getElementById("btn-new-profile");f.addEventListener("click",function(h){var g=prompt("New profile name?","New Profile");if(g==null){return}var i=a.Data.createEmptyProfile();i.title=g;a.theRepo.profiles.push(i);a.theRepo.parse(function(){a.theRepo.activeProfile=a.theRepo.profiles.length-1;a.theClock.loadActiveProfile();a.theRepo.store();d()})})}c.init=e;function d(){var g=document.getElementById("profiles-dropdown-proflist");g.innerHTML="";var f=[];_.each(a.theRepo.profiles,function(i,h){f.push({k:h,n:i.title})});f.sort(function(i,h){return i.n.localeCompare(h.n)});_.each(f,function(i){var h=document.createElement("a");h.textContent=i.n;h.dataset.index=i.k;h.classList.add("icon-profile");h.addEventListener("click",function(){a.theRepo.activeProfile=this.dataset.index;a.theRepo.store();a.theClock.loadActiveProfile()});g.appendChild(h)})}c.buildProfilesMenu=d})(b=a.Menu||(a.Menu={}))})(Tzork||(Tzork={}));var Tzork;(function(a){var b;(function(m){var h;var j=false;var d;function q(){$("#menu-btn-edit").on("click",g);$(".DialogGui .Tab").on("click",function(){$(".DialogGui .Pane.content").addClass("gone");$(".DialogGui .Tab").removeClass("active");var r=$(this).data("action");$("#pane_"+r).removeClass("gone");$(this).addClass("active");d=r});$("#field_title").on("change paste keypress keyup keydown",function(){var r=this;setTimeout(function(){h.title=$(r).val();n()},1)});$("#profile_json").on("change paste keypress keyup keydown",function(){p(true)});$("#setup-json-btn-revert").on("click",l);$("#setup-json-btn-apply").on("click",c);$("#prof-edit-btn-destroy").on("click",function(){o("delete")});$("#prof-edit-btn-close").on("click",function(){o("close")});$("#prof-edit-btn-save").on("click",function(){o("save")});$(".Modal").on("click",function(){o("close")});$(".DialogGui").on("click",function(r){r.stopImmediatePropagation();r.preventDefault()});$(window).on("keyup",function(r){if(r.which==27){o("close")}});k("json")}m.init=q;function k(r){$(".DialogGui .Pane.content").addClass("gone");$(".DialogGui .Tab").removeClass("active");$("#pane_"+r).removeClass("gone");$("#tab-btn-"+r).addClass("active");d=r}function p(r){$("#json_change_buttons").toggleClass("disabled",!r);j=r;if(!r){$("#json_error").empty()}}function n(){$("#profile_json").val(JSON.stringify(h,null,"\t"));p(false)}function f(){$("#field_title").val(h.title)}function g(){h=a.Data.stripProfile(a.theRepo.getActiveProfile());n();f();$("#json_error").empty();var r=document.getElementById("profile_edit_dialog");r.style.display="block";setTimeout(function(){r.style.opacity="1"},1)}m.openDialog=g;function i(){var r=document.getElementById("profile_edit_dialog");r.style.opacity="0";setTimeout(function(){r.style.display="none"},500)}m.closeDialog=i;function e(){a.theRepo.parse(function(){a.theClock.loadActiveProfile();a.theRepo.store();a.Menu.buildProfilesMenu();i()})}function o(r){switch(r){case"delete":if(confirm("Delete current profile?")){a.theRepo.profiles.splice(a.theRepo.activeProfile,1);e()}break;case"close":i();break;case"save":if(d=="json"&&j){if(!c()){return}}a.theRepo.profiles[a.theRepo.activeProfile]=h;e();break}}m.submitProfileEdit=o;function l(){if(!j){return}n();p(false)}m.revertJsonEdit=l;function c(){if(!j){return}try{h=JSON.parse($("#profile_json").val());p(false);return true}catch(r){var s=document.getElementById("json_error");if(r.message.match(/^Unexpected token [,\]}]/g)){s.textContent="Syntax error: trailing comma ?"}else{if(r.message.match(/^Unexpected string/g)){s.textContent="Syntax error: missing comma ?"}else{s.textContent="Syntax error: "+r.message}}console.log("Error in user-entered JSON",r);return false}}m.submitJsonEdit=c})(b=a.ProfileEditor||(a.ProfileEditor={}))})(Tzork||(Tzork={}));var Tzork;(function(a){a.theClock;a.theRepo;a.theConfig;function b(d,c){a.theRepo=d;a.theConfig=c;a.theClock=new a.Clock();a.ProfileEditor.init();a.Menu.init();Utils.fixTextareaTabKey()}a.init=b})(Tzork||(Tzork={}));var Tzork;(function(b){function a(){var d=new b.Data.LocalRepository();var c=new b.Data.LocalConfigProvider();d.load(function(){b.init(d,c)})}b.main=a})(Tzork||(Tzork={}));