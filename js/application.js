var tz_aliases = {
    "Afghanistan": "Asia/Kabul",
    "Aland Islands": "Europe/Mariehamn",
    "Albania": "Europe/Tirane",
    "Algeria": "Africa/Algiers",
    "American Samoa": "Pacific/Pago_Pago",
    "Andorra": "Europe/Andorra",
    "Angola": "Africa/Luanda",
    "Anguilla": "America/Anguilla",
    "Antigua and Barbuda": "America/Antigua",
    "Armenia": "Asia/Yerevan",
    "Aruba": "America/Aruba",
    "Austria": "Europe/Vienna",
    "Azerbaijan": "Asia/Baku",
    "Bahamas": "America/Nassau",
    "Bahrain": "Asia/Bahrain",
    "Bangladesh": "Asia/Dhaka",
    "Barbados": "America/Barbados",
    "Belarus": "Europe/Minsk",
    "Belgium": "Europe/Brussels",
    "Belize": "America/Belize",
    "Benin": "Africa/Porto-Novo",
    "Bermuda": "Atlantic/Bermuda",
    "Bhutan": "Asia/Thimphu",
    "Bolivia": "America/La_Paz",
    "Bonaire, Saint Eustatius and Saba": "America/Kralendijk",
    "Bosnia and Herzegovina": "Europe/Sarajevo",
    "Botswana": "Africa/Gaborone",
    "British Indian Ocean Territory": "Indian/Chagos",
    "British Virgin Islands": "America/Tortola",
    "Brunei": "Asia/Brunei",
    "Bulgaria": "Europe/Sofia",
    "Burkina Faso": "Africa/Ouagadougou",
    "Burundi": "Africa/Bujumbura",
    "Cambodia": "Asia/Phnom_Penh",
    "Cameroon": "Africa/Douala",
    "Cape Verde": "Atlantic/Cape_Verde",
    "Cayman Islands": "America/Cayman",
    "Central African Republic": "Africa/Bangui",
    "Chad": "Africa/Ndjamena",
    "Christmas Island": "Indian/Christmas",
    "Cocos Islands": "Indian/Cocos",
    "Colombia": "America/Bogota",
    "Comoros": "Indian/Comoro",
    "Cook Islands": "Pacific/Rarotonga",
    "Costa Rica": "America/Costa_Rica",
    "Croatia": "Europe/Zagreb",
    "Cuba": "America/Havana",
    "Curaçao": "America/Curacao",
    "Cyprus": "Asia/Nicosia",
    "Czech Republic": "Europe/Prague",
    "Denmark": "Europe/Copenhagen",
    "Djibouti": "Africa/Djibouti",
    "Dominica": "America/Dominica",
    "Dominican Republic": "America/Santo_Domingo",
    "East Timor": "Asia/Dili",
    "Egypt": "Africa/Cairo",
    "El Salvador": "America/El_Salvador",
    "Equatorial Guinea": "Africa/Malabo",
    "Eritrea": "Africa/Asmara",
    "Estonia": "Europe/Tallinn",
    "Ethiopia": "Africa/Addis_Ababa",
    "Falkland Islands": "Atlantic/Stanley",
    "Faroe Islands": "Atlantic/Faroe",
    "Fiji": "Pacific/Fiji",
    "Finland": "Europe/Helsinki",
    "France": "Europe/Paris",
    "French Guiana": "America/Cayenne",
    "French Southern Territories": "Indian/Kerguelen",
    "Gabon": "Africa/Libreville",
    "Gambia": "Africa/Banjul",
    "Georgia": "Asia/Tbilisi",
    "Ghana": "Africa/Accra",
    "Gibraltar": "Europe/Gibraltar",
    "Greece": "Europe/Athens",
    "Grenada": "America/Grenada",
    "Guadeloupe": "America/Guadeloupe",
    "Guam": "Pacific/Guam",
    "Guatemala": "America/Guatemala",
    "Guernsey": "Europe/Guernsey",
    "Guinea": "Africa/Conakry",
    "Guinea-Bissau": "Africa/Bissau",
    "Guyana": "America/Guyana",
    "Haiti": "America/Port-au-Prince",
    "Honduras": "America/Tegucigalpa",
    "Hong Kong": "Asia/Hong_Kong",
    "Hungary": "Europe/Budapest",
    "Iceland": "Atlantic/Reykjavik",
    "India": "Asia/Kolkata",
    "Iran": "Asia/Tehran",
    "Iraq": "Asia/Baghdad",
    "Ireland": "Europe/Dublin",
    "Isle of Man": "Europe/Isle_of_Man",
    "Israel": "Asia/Jerusalem",
    "Italy": "Europe/Rome",
    "Ivory Coast": "Africa/Abidjan",
    "Jamaica": "America/Jamaica",
    "Japan": "Asia/Tokyo",
    "Jersey": "Europe/Jersey",
    "Jordan": "Asia/Amman",
    "Kenya": "Africa/Nairobi",
    "Kuwait": "Asia/Kuwait",
    "Kyrgyzstan": "Asia/Bishkek",
    "Laos": "Asia/Vientiane",
    "Latvia": "Europe/Riga",
    "Lebanon": "Asia/Beirut",
    "Lesotho": "Africa/Maseru",
    "Liberia": "Africa/Monrovia",
    "Libya": "Africa/Tripoli",
    "Liechtenstein": "Europe/Vaduz",
    "Lithuania": "Europe/Vilnius",
    "Luxembourg": "Europe/Luxembourg",
    "Macao": "Asia/Macau",
    "Macedonia": "Europe/Skopje",
    "Madagascar": "Indian/Antananarivo",
    "Malawi": "Africa/Blantyre",
    "Maldives": "Indian/Maldives",
    "Mali": "Africa/Bamako",
    "Malta": "Europe/Malta",
    "Martinique": "America/Martinique",
    "Mauritania": "Africa/Nouakchott",
    "Mauritius": "Indian/Mauritius",
    "Mayotte": "Indian/Mayotte",
    "Moldova": "Europe/Chisinau",
    "Monaco": "Europe/Monaco",
    "Montenegro": "Europe/Podgorica",
    "Montserrat": "America/Montserrat",
    "Morocco": "Africa/Casablanca",
    "Mozambique": "Africa/Maputo",
    "Myanmar": "Asia/Rangoon",
    "Namibia": "Africa/Windhoek",
    "Nauru": "Pacific/Nauru",
    "Nepal": "Asia/Kathmandu",
    "Netherlands": "Europe/Amsterdam",
    "New Caledonia": "Pacific/Noumea",
    "Nicaragua": "America/Managua",
    "Niger": "Africa/Niamey",
    "Nigeria": "Africa/Lagos",
    "Niue": "Pacific/Niue",
    "Norfolk Island": "Pacific/Norfolk",
    "North Korea": "Asia/Pyongyang",
    "Northern Mariana Islands": "Pacific/Saipan",
    "Norway": "Europe/Oslo",
    "Oman": "Asia/Muscat",
    "Pakistan": "Asia/Karachi",
    "Palau": "Pacific/Palau",
    "Panama": "America/Panama",
    "Paraguay": "America/Asuncion",
    "Peru": "America/Lima",
    "Philippines": "Asia/Manila",
    "Pitcairn": "Pacific/Pitcairn",
    "Poland": "Europe/Warsaw",
    "Puerto Rico": "America/Puerto_Rico",
    "Qatar": "Asia/Qatar",
    "Republic of the Congo": "Africa/Brazzaville",
    "Reunion": "Indian/Reunion",
    "Romania": "Europe/Bucharest",
    "Rwanda": "Africa/Kigali",
    "Saint Barthélemy": "America/St_Barthelemy",
    "Saint Helena": "Atlantic/St_Helena",
    "Saint Kitts and Nevis": "America/St_Kitts",
    "Saint Lucia": "America/St_Lucia",
    "Saint Martin": "America/Marigot",
    "Saint Pierre and Miquelon": "America/Miquelon",
    "Saint Vincent and the Grenadines": "America/St_Vincent",
    "Samoa": "Pacific/Apia",
    "San Marino": "Europe/San_Marino",
    "Sao Tome and Principe": "Africa/Sao_Tome",
    "Saudi Arabia": "Asia/Riyadh",
    "Senegal": "Africa/Dakar",
    "Serbia": "Europe/Belgrade",
    "Seychelles": "Indian/Mahe",
    "Sierra Leone": "Africa/Freetown",
    "Singapore": "Asia/Singapore",
    "Sint Maarten": "America/Lower_Princes",
    "Slovakia": "Europe/Bratislava",
    "Slovenia": "Europe/Ljubljana",
    "Solomon Islands": "Pacific/Guadalcanal",
    "Somalia": "Africa/Mogadishu",
    "South Africa": "Africa/Johannesburg",
    "South Georgia and the South Sandwich Islands": "Atlantic/South_Georgia",
    "South Korea": "Asia/Seoul",
    "South Sudan": "Africa/Juba",
    "Sri Lanka": "Asia/Colombo",
    "Sudan": "Africa/Khartoum",
    "Suriname": "America/Paramaribo",
    "Svalbard and Jan Mayen": "Arctic/Longyearbyen",
    "Swaziland": "Africa/Mbabane",
    "Sweden": "Europe/Stockholm",
    "Switzerland": "Europe/Zurich",
    "Syria": "Asia/Damascus",
    "Taiwan": "Asia/Taipei",
    "Tajikistan": "Asia/Dushanbe",
    "Tanzania": "Africa/Dar_es_Salaam",
    "Thailand": "Asia/Bangkok",
    "Togo": "Africa/Lome",
    "Tokelau": "Pacific/Fakaofo",
    "Tonga": "Pacific/Tongatapu",
    "Trinidad and Tobago": "America/Port_of_Spain",
    "Tunisia": "Africa/Tunis",
    "Turkey": "Europe/Istanbul",
    "Turkmenistan": "Asia/Ashgabat",
    "Turks and Caicos Islands": "America/Grand_Turk",
    "Tuvalu": "Pacific/Funafuti",
    "U.S. Virgin Islands": "America/St_Thomas",
    "Uganda": "Africa/Kampala",
    "United Arab Emirates": "Asia/Dubai",
    "United Kingdom": "Europe/London",
    "UK": "Europe/London",
    "GB": "Europe/London",
    "Great Britain": "Europe/London",
    "Uruguay": "America/Montevideo",
    "Vanuatu": "Pacific/Efate",
    "Vatican": "Europe/Vatican",
    "Venezuela": "America/Caracas",
    "Vietnam": "Asia/Ho_Chi_Minh",
    "Wallis and Futuna": "Pacific/Wallis",
    "Western Sahara": "Africa/El_Aaiun",
    "Yemen": "Asia/Aden",
    "Zambia": "Africa/Lusaka",
    "Zimbabwe": "Africa/Harare",
    "Germany": "Europe/Berlin",
    "Busingen": "Europe/Busingen",
    "Germany, Busingen": "Europe/Busingen",
    "Galapagos": "Pacific/Galapagos",
    "Ecuador": "America/Guayaquil",
    "Chile": "America/Santiago",
    "Easter Island": "Pacific/Easter",
    "Spain": "Europe/Madrid",
    "Portugal": "Europe/Lisbon",
    "Madeira": "Atlantic/Madeira",
    "Azores": "Atlantic/Azores",
    "Ceuta": "Africa/Ceuta",
    "Canary": "Atlantic/Canary",
    "Antarctica, McMurdo": "Antarctica/McMurdo",
    "Antarctica, Rothera": "Antarctica/Rothera",
    "Antarctica, Palmer": "Antarctica/Palmer",
    "Antarctica, Mawson": "Antarctica/Mawson",
    "Antarctica, Davis": "Antarctica/Davis",
    "Antarctica, Casey": "Antarctica/Casey",
    "Antarctica, Vostok": "Antarctica/Vostok",
    "Antarctica, DumontDUrville": "Antarctica/DumontDUrville",
    "Antarctica, Syowa": "Antarctica/Syowa",
    "Antarctica, Troll": "Antarctica/Troll",
    "Antarctica, Macquarie": "Antarctica/Macquarie",
    "Argentina, Buenos Aires": "America/Argentina/Buenos_Aires",
    "Argentina, Cordoba": "America/Argentina/Cordoba",
    "Argentina, Salta": "America/Argentina/Salta",
    "Argentina, Jujuy": "America/Argentina/Jujuy",
    "Argentina, Tucuman": "America/Argentina/Tucuman",
    "Argentina, Catamarca": "America/Argentina/Catamarca",
    "Argentina, La Rioja": "America/Argentina/La_Rioja",
    "Argentina, San Juan": "America/Argentina/San_Juan",
    "Argentina, Mendoza": "America/Argentina/Mendoza",
    "Argentina, San Luis": "America/Argentina/San_Luis",
    "Argentina, Rio Gallegos": "America/Argentina/Rio_Gallegos",
    "Argentina, Ushuaia": "America/Argentina/Ushuaia",
    "Australia, Lord Howe": "Australia/Lord_Howe",
    "Australia, Hobart": "Australia/Hobart",
    "Australia, Currie": "Australia/Currie",
    "Australia, Melbourne": "Australia/Melbourne",
    "Australia, Sydney": "Australia/Sydney",
    "Australia, Broken Hill": "Australia/Broken_Hill",
    "Australia, Brisbane": "Australia/Brisbane",
    "Australia, Lindeman": "Australia/Lindeman",
    "Australia, Adelaide": "Australia/Adelaide",
    "Australia, Darwin": "Australia/Darwin",
    "Australia, Perth": "Australia/Perth",
    "Australia, Eucla": "Australia/Eucla",
    "Brazil, Noronha": "America/Noronha",
    "Brazil, Belem": "America/Belem",
    "Brazil, Fortaleza": "America/Fortaleza",
    "Brazil, Recife": "America/Recife",
    "Brazil, Araguaina": "America/Araguaina",
    "Brazil, Maceio": "America/Maceio",
    "Brazil, Bahia": "America/Bahia",
    "Brazil, Sao Paulo": "America/Sao_Paulo",
    "Brazil, Campo Grande": "America/Campo_Grande",
    "Brazil, Cuiaba": "America/Cuiaba",
    "Brazil, Santarem": "America/Santarem",
    "Brazil, Porto Velho": "America/Porto_Velho",
    "Brazil, Boa Vista": "America/Boa_Vista",
    "Brazil, Manaus": "America/Manaus",
    "Brazil, Eirunepe": "America/Eirunepe",
    "Brazil, Rio Branco": "America/Rio_Branco",
    "Canada, St_Johns": "America/St_Johns",
    "Canada, Halifax": "America/Halifax",
    "Canada, Glace Bay": "America/Glace_Bay",
    "Canada, Moncton": "America/Moncton",
    "Canada, Goose Bay": "America/Goose_Bay",
    "Canada, Blanc-Sablon": "America/Blanc-Sablon",
    "Canada, Toronto": "America/Toronto",
    "Canada, Nipigon": "America/Nipigon",
    "Canada, Thunder Bay": "America/Thunder_Bay",
    "Canada, Iqaluit": "America/Iqaluit",
    "Canada, Pangnirtung": "America/Pangnirtung",
    "Canada, Resolute": "America/Resolute",
    "Canada, Atikokan": "America/Atikokan",
    "Canada, Rankin Inlet": "America/Rankin_Inlet",
    "Canada, Winnipeg": "America/Winnipeg",
    "Canada, Rainy River": "America/Rainy_River",
    "Canada, Regina": "America/Regina",
    "Canada, Swift Current": "America/Swift_Current",
    "Canada, Edmonton": "America/Edmonton",
    "Canada, Cambridge Bay": "America/Cambridge_Bay",
    "Canada, Yellowknife": "America/Yellowknife",
    "Canada, Inuvik": "America/Inuvik",
    "Canada, Creston": "America/Creston",
    "Canada, Dawson Creek": "America/Dawson_Creek",
    "Canada, Vancouver": "America/Vancouver",
    "Canada, Whitehorse": "America/Whitehorse",
    "Canada, Dawson": "America/Dawson",
    "China, Shanghai": "Asia/Shanghai",
    "China, Urumqi": "Asia/Urumqi",
    "Congo, Kinshasa": "Africa/Kinshasa",
    "Congo, Lubumbashi": "Africa/Lubumbashi",
    "French Polynesia, Tahiti": "Pacific/Tahiti",
    "French Polynesia, Marquesas": "Pacific/Marquesas",
    "French Polynesia, Gambier": "Pacific/Gambier",
    "Greenland, Godthab": "America/Godthab",
    "Greenland, Danmarkshavn": "America/Danmarkshavn",
    "Greenland, Scoresbysund": "America/Scoresbysund",
    "Greenland, Thule": "America/Thule",
    "Indonesia, Jakarta": "Asia/Jakarta",
    "Indonesia, Pontianak": "Asia/Pontianak",
    "Indonesia, Makassar": "Asia/Makassar",
    "Indonesia, Jayapura": "Asia/Jayapura",
    "Kazakhstan, Almaty": "Asia/Almaty",
    "Kazakhstan, Qyzylorda": "Asia/Qyzylorda",
    "Kazakhstan, Aqtobe": "Asia/Aqtobe",
    "Kazakhstan, Aqtau": "Asia/Aqtau",
    "Kazakhstan, Oral": "Asia/Oral",
    "Kiribati, Tarawa": "Pacific/Tarawa",
    "Kiribati, Enderbury": "Pacific/Enderbury",
    "Kiribati, Kiritimati": "Pacific/Kiritimati",
    "Malaysia, Kuala Lumpur": "Asia/Kuala_Lumpur",
    "Malaysia, Kuching": "Asia/Kuching",
    "Marshall Islands, Majuro": "Pacific/Majuro",
    "Marshall Islands, Kwajalein": "Pacific/Kwajalein",
    "Mexico": "America/Mexico_City",
    "Mexico, Mexico City": "America/Mexico_City",
    "Mexico, Cancun": "America/Cancun",
    "Mexico, Merida": "America/Merida",
    "Mexico, Monterrey": "America/Monterrey",
    "Mexico, Matamoros": "America/Matamoros",
    "Mexico, Mazatlan": "America/Mazatlan",
    "Mexico, Chihuahua": "America/Chihuahua",
    "Mexico, Ojinaga": "America/Ojinaga",
    "Mexico, Hermosillo": "America/Hermosillo",
    "Mexico, Tijuana": "America/Tijuana",
    "Mexico, Santa Isabel": "America/Santa_Isabel",
    "Mexico, Bahia Banderas": "America/Bahia_Banderas",
    "Micronesia, Chuuk": "Pacific/Chuuk",
    "Micronesia, Pohnpei": "Pacific/Pohnpei",
    "Micronesia, Kosrae": "Pacific/Kosrae",
    "Mongolia, Ulaanbaatar": "Asia/Ulaanbaatar",
    "Mongolia, Hovd": "Asia/Hovd",
    "Mongolia, Choibalsan": "Asia/Choibalsan",
    "New Zealand, Auckland": "Pacific/Auckland",
    "New Zealand, Chatham": "Pacific/Chatham",
    "Palestina, Gaza": "Asia/Gaza",
    "Palestina, Hebron": "Asia/Hebron",
    "Papua New Guinea, Port_Moresby": "Pacific/Port_Moresby",
    "Papua New Guinea, Bougainville": "Pacific/Bougainville",
    "Russia, Kaliningrad": "Europe/Kaliningrad",
    "Russia, Moscow": "Europe/Moscow",
    "Russia, Simferopol": "Europe/Simferopol",
    "Russia, Volgograd": "Europe/Volgograd",
    "Russia, Samara": "Europe/Samara",
    "Russia, Yekaterinburg": "Asia/Yekaterinburg",
    "Russia, Omsk": "Asia/Omsk",
    "Russia, Novosibirsk": "Asia/Novosibirsk",
    "Russia, Novokuznetsk": "Asia/Novokuznetsk",
    "Russia, Krasnoyarsk": "Asia/Krasnoyarsk",
    "Russia, Irkutsk": "Asia/Irkutsk",
    "Russia, Chita": "Asia/Chita",
    "Russia, Yakutsk": "Asia/Yakutsk",
    "Russia, Khandyga": "Asia/Khandyga",
    "Russia, Vladivostok": "Asia/Vladivostok",
    "Russia, Sakhalin": "Asia/Sakhalin",
    "Russia, Ust-Nera": "Asia/Ust-Nera",
    "Russia, Magadan": "Asia/Magadan",
    "Russia, Srednekolymsk": "Asia/Srednekolymsk",
    "Russia, Kamchatka": "Asia/Kamchatka",
    "Russia, Anadyr": "Asia/Anadyr",
    "Ukraine, Kiev": "Europe/Kiev",
    "Ukraine, Uzhgorod": "Europe/Uzhgorod",
    "Ukraine, Zaporozhye": "Europe/Zaporozhye",
    "Uzbekistan, Samarkand": "Asia/Samarkand",
    "Uzbekistan, Tashkent": "Asia/Tashkent",
    "United States, New York": "America/New_York",
    "United States, Michigan - Detroit": "America/Detroit",
    "United States, Michigan - Menominee": "America/Menominee",
    "United States, Kentucky - Louisville": "America/Kentucky/Louisville",
    "United States, Kentucky - Monticello": "America/Kentucky/Monticello",
    "United States, Indiana - Indianapolis": "America/Indiana/Indianapolis",
    "United States, Indiana - Vincennes": "America/Indiana/Vincennes",
    "United States, Indiana - Winamac": "America/Indiana/Winamac",
    "United States, Indiana - Marengo": "America/Indiana/Marengo",
    "United States, Indiana - Petersburg": "America/Indiana/Petersburg",
    "United States, Indiana - Vevay": "America/Indiana/Vevay",
    "United States, Indiana - Tell City": "America/Indiana/Tell_City",
    "United States, Indiana - Knox": "America/Indiana/Knox",
    "United States, Illinois": "America/Chicago",
    "United States, North Dakota - Center": "America/North_Dakota/Center",
    "United States, North Dakota - New Salem": "America/North_Dakota/New_Salem",
    "United States, North Dakota - Beulah": "America/North_Dakota/Beulah",
    "United States, Colorado": "America/Denver",
    "United States, Idaho": "America/Boise",
    "United States, Arizona": "America/Phoenix",
    "United States, California": "America/Los_Angeles",
    "United States, Alaska - Metlakatla": "America/Metlakatla",
    "United States, Alaska - Anchorage": "America/Anchorage",
    "United States, Alaska - Juneau": "America/Juneau",
    "United States, Alaska - Sitka": "America/Sitka",
    "United States, Alaska - Yakutat": "America/Yakutat",
    "United States, Alaska - Nome": "America/Nome",
    "United States, Alaska - Adak": "America/Adak",
    "United States, Hawaii": "Pacific/Honolulu",
    "USA, New York": "America/New_York",
    "USA, Michigan - Detroit": "America/Detroit",
    "USA, Michigan - Menominee": "America/Menominee",
    "USA, Kentucky - Louisville": "America/Kentucky/Louisville",
    "USA, Kentucky - Monticello": "America/Kentucky/Monticello",
    "USA, Indiana - Indianapolis": "America/Indiana/Indianapolis",
    "USA, Indiana - Vincennes": "America/Indiana/Vincennes",
    "USA, Indiana - Winamac": "America/Indiana/Winamac",
    "USA, Indiana - Marengo": "America/Indiana/Marengo",
    "USA, Indiana - Petersburg": "America/Indiana/Petersburg",
    "USA, Indiana - Vevay": "America/Indiana/Vevay",
    "USA, Indiana - Tell City": "America/Indiana/Tell_City",
    "USA, Indiana - Knox": "America/Indiana/Knox",
    "USA, Illinois": "America/Chicago",
    "USA, North Dakota - Center": "America/North_Dakota/Center",
    "USA, North Dakota - New Salem": "America/North_Dakota/New_Salem",
    "USA, North Dakota - Beulah": "America/North_Dakota/Beulah",
    "USA, Colorado": "America/Denver",
    "USA, Idaho": "America/Boise",
    "USA, Arizona": "America/Phoenix",
    "USA, California": "America/Los_Angeles",
    "USA, Alaska - Metlakatla": "America/Metlakatla",
    "USA, Alaska - Anchorage": "America/Anchorage",
    "USA, Alaska - Juneau": "America/Juneau",
    "USA, Alaska - Sitka": "America/Sitka",
    "USA, Alaska - Yakutat": "America/Yakutat",
    "USA, Alaska - Nome": "America/Nome",
    "USA, Alaska - Adak": "America/Adak",
    "USA, Hawaii": "Pacific/Honolulu",
    "Hawaii": "Pacific/Honolulu",
    "USA, Eastern Time": "America/New_York",
    "USA, Central Time": "America/Chicago",
    "USA, Mountain Time": "America/Denver",
    "USA, Pacific Time": "America/Los_Angeles",
    "GMT": "Africa/Dakar",
    "UTC": "Africa/Dakar",
    "CET": "Europe/Berlin",
    "CEST": "Europe/Berlin"
};
var Ajax;
(function (Ajax) {
    function get(url, success, failure) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4) {
                if (xhr.status >= 200 && xhr.status < 400) {
                    if (typeof success == 'function')
                        success(xhr.responseText);
                }
                else {
                    if (typeof failure == 'function')
                        failure(xhr.status);
                }
            }
        };
        xhr.onerror = function () {
            if (typeof failure == 'function')
                failure(-1);
        };
        xhr.send();
    }
    Ajax.get = get;
})(Ajax || (Ajax = {}));
var TzResolver;
(function (TzResolver) {
    var people_loading;
    function resolvePointTimezones(points, onDone) {
        people_loading = 0;
        points.forEach(function (obj) {
            obj._valid = true;
            var bad = false;
            ['name', 'color', 'tz'].forEach(function (e) {
                if (typeof (obj[e]) == 'undefined') {
                    console.error('Missing "' + e + '" field in point object', obj);
                    bad = true;
                }
            });
            if (bad) {
                obj._valid = false;
                return;
            }
            people_loading++;
            resolveTimezone(obj);
        });
        function probe() {
            if (people_loading <= 0) {
                console.log('LOADING DONE');
                onDone();
                return;
            }
            setTimeout(probe, 10);
        }
        probe();
    }
    TzResolver.resolvePointTimezones = resolvePointTimezones;
    function resolveTimezone(obj) {
        obj._tz = obj.tz;
        if (obj.tz in tz_aliases) {
            obj._tz = tz_aliases[obj.tz];
            console.log('TZ "' + obj.tz + '" resolved as "' + obj._tz + '"');
        }
        if (moment.tz.zone(obj._tz)) {
            people_loading--;
            return;
        }
        scheduleGoogleReq(obj);
    }
    var last_google_call_timestamp = 0;
    function scheduleGoogleReq(obj) {
        var elapsed = (Date.now() - last_google_call_timestamp);
        var t = Math.max(0, (105 - elapsed));
        if (t == 0) {
            last_google_call_timestamp = Date.now();
            getTimezoneFromGoogleAPIs(obj);
            return;
        }
        setTimeout(function () {
            scheduleGoogleReq(obj);
        }, t);
    }
    function getTimezoneFromGoogleAPIs(obj) {
        var geoURL = "https://maps.googleapis.com/maps/api/geocode/json?sensor=false&address=" + encodeURIComponent(obj.tz);
        function ajaxFail(resp) {
            console.log('FAIL: code ' + resp);
            obj._valid = false;
            people_loading--;
        }
        function geoOK(resp) {
            try {
                var rj = JSON.parse(resp);
                console.log('Reply from geoAPI:', rj);
                if (rj.status !== 'OK') {
                    obj._valid = false;
                    people_loading--;
                    return;
                }
                var results = rj.results;
                if (results.length > 1) {
                    console.error('WARNING: Google found multiple matches. Try to be more specific at "' + obj.tz + '"');
                }
                var loc = results[0].geometry.location;
                var now = Math.floor(Date.now() / 1000);
                var tzURL = "https://maps.googleapis.com/maps/api/timezone/json?location=" + loc.lat + "," + loc.lng + "&timestamp=" + now + "&sensor=false";
                Ajax.get(tzURL, tzOK, ajaxFail);
            }
            catch (e) {
                console.log(e);
                obj._valid = false;
                people_loading--;
            }
        }
        function tzOK(resp) {
            try {
                var rj = JSON.parse(resp);
                console.log('Reply from Google:', rj);
                if (rj.status !== 'OK') {
                    obj._valid = false;
                    people_loading--;
                    return;
                }
                console.log('Resolved TZ as ' + rj.timeZoneId);
                obj._tz = rj.timeZoneId;
                people_loading--;
            }
            catch (e) {
                console.log(e);
                obj._valid = false;
                people_loading--;
            }
        }
        Ajax.get(geoURL, geoOK, ajaxFail);
    }
    function getTimezoneForPoint(obj) {
        return obj._tz;
    }
    TzResolver.getTimezoneForPoint = getTimezoneForPoint;
    function getTimeForPoint(obj) {
        var mmt = moment().tz(obj._tz);
        return mmt.hour() * 3600 + mmt.minute() * 60 + mmt.second();
    }
    TzResolver.getTimeForPoint = getTimeForPoint;
})(TzResolver || (TzResolver = {}));
if (!Date.now) {
    Date.now = function () {
        return new Date().getTime();
    };
}
var Utils;
(function (Utils) {
    function clamp(what, low, high) {
        return Math.min(low, Math.max(high, what));
    }
    Utils.clamp = clamp;
    function hour2angle(h) {
        var a = (18 - h) * 15;
        while (a < 0)
            a += 360;
        return a;
    }
    Utils.hour2angle = hour2angle;
    function positionAt(element, angle, distance, octant) {
        if (octant === void 0) { octant = 0; }
        var xx = distance * Math.cos((angle / 180) * Math.PI);
        var yy = distance * Math.sin((angle / 180) * Math.PI);
        switch (octant) {
            case 0:
            case 1:
            case 7:
                element.style.left = (50 + xx) + '%';
                element.style.top = (50 - yy) + '%';
                break;
            case 2:
            case 3:
            case 4:
                element.style.right = (50 - xx) + '%';
                element.style.top = (50 - yy) + '%';
                break;
            case 5:
                element.style.right = (50 - xx) + '%';
                element.style.bottom = (50 + yy) + '%';
                break;
            case 6:
                element.style.left = (50 + xx) + '%';
                element.style.bottom = (50 + yy) + '%';
                break;
        }
    }
    Utils.positionAt = positionAt;
    function mmtDayCompare(here, there) {
        var d0 = here.dayOfYear();
        var y0 = here.year();
        var d1 = there.dayOfYear();
        var y1 = there.year();
        if (y1 < y0) {
            return -1;
        }
        else if (y1 > y0) {
            return 1;
        }
        else {
            if (d1 < d0) {
                return -1;
            }
            else if (d1 > d0) {
                return 1;
            }
        }
        return 0;
    }
    Utils.mmtDayCompare = mmtDayCompare;
})(Utils || (Utils = {}));
var Tzork;
(function (Tzork) {
    function stripProfile(p) {
        p = JSON.parse(JSON.stringify(p));
        delete p._valid;
        p.points.forEach(function (gp) {
            delete gp._t;
            delete gp._tz;
            delete gp._valid;
        });
        return p;
    }
    function createDefaultProfile() {
        return {
            title: 'Untitled Profile',
            innerImage: "images/earth-from-space-small.jpg",
            outerColor: '#07151D',
            fgColor: '#9cfff7',
            points: []
        };
    }
    var LocalRepository = (function () {
        function LocalRepository() {
            this.profiles = [];
            this.activeProfile = 0;
        }
        LocalRepository.prototype.load = function (onDone) {
            try {
                var s = localStorage['profiles'];
                if (s != null) {
                    this.profiles = JSON.parse(s) || [];
                }
            }
            catch (e) {
                console.error('Error reading profiles from localStorage', e);
            }
            try {
                var s = localStorage['activeProfile'];
                if (s != null) {
                    this.activeProfile = parseInt(s);
                }
                this.activeProfile = Utils.clamp(this.activeProfile, 0, this.profiles.length);
            }
            catch (e) {
                console.error('Error reading activeProfile from localStorage', e);
            }
            if (this.profiles.length == 0) {
                this.profiles.push(createDefaultProfile());
            }
            var loading = 0;
            this.profiles.forEach(function (p) {
                if (typeof p.points == 'undefined') {
                    p.points = [];
                }
                loading++;
                TzResolver.resolvePointTimezones(p.points, function () {
                    loading--;
                });
            });
            (function probe() {
                if (loading == 0) {
                    (typeof onDone == 'function') && onDone();
                }
                else {
                    setTimeout(probe, 5);
                }
            })();
        };
        LocalRepository.prototype.store = function (onDone) {
            var outp = [];
            this.profiles.forEach(function (pr) {
                outp.push(stripProfile(pr));
            });
            localStorage['profiles'] = JSON.stringify(outp);
            localStorage['activeProfile'] = this.activeProfile;
            (typeof onDone == 'function') && onDone();
        };
        return LocalRepository;
    })();
    Tzork.LocalRepository = LocalRepository;
})(Tzork || (Tzork = {}));
var Tzork;
(function (Tzork) {
    var Clock = (function () {
        function Clock() {
            this.disc = document.getElementById('disc');
            this.buildClockMarks();
            this.updateTime();
            this.interval_time = setInterval(this.updateTime, 1000);
        }
        Clock.prototype.loadActiveProfile = function () {
            this.clear();
            this.populate(Tzork.theRepo.profiles[Tzork.theRepo.activeProfile]);
        };
        Clock.prototype.populate = function (profile) {
            console.log('Populate with profile: ', profile);
            this.profile = profile;
            var outer = document.getElementById('tzork-bg');
            var inner = this.disc;
            if (profile.outerImage != null) {
                outer.style.backgroundImage = 'url(\"' + profile.outerImage + '\")';
            }
            else {
                outer.style.backgroundImage = 'none';
            }
            if (profile.innerImage != null) {
                inner.style.backgroundImage = 'url(\"' + profile.innerImage + '\")';
            }
            else {
                inner.style.backgroundImage = 'none';
            }
            if (profile.outerColor != null) {
                outer.style.backgroundColor = profile.outerColor;
            }
            else {
                outer.style.backgroundColor = '#07151D';
            }
            if (profile.innerColor != null) {
                inner.style.backgroundColor = profile.innerColor;
            }
            else {
                inner.style.backgroundColor = 'transparent';
            }
            this.updatePoints();
            var _self = this;
            this.interval_people = setInterval(function () {
                _self.updatePoints();
            }, 1000 * 10);
            window.onfocus = function () {
                this.updatePoints();
                this.updateTime();
            };
            var e = document.getElementById('setup_btn');
            e.addEventListener('click', function () {
            });
        };
        Clock.prototype.clear = function () {
            var old = document.querySelectorAll('.bullet, .person-label, .people-list');
            for (var i = 0; i < old.length; i++) {
                old[i].parentNode.removeChild(old[i]);
            }
            clearInterval(this.interval_people);
        };
        Clock.prototype.buildClockMarks = function () {
            for (var i = 0; i < 24; i++) {
                var mark = document.createElement('div');
                mark.classList.add('mark');
                mark.classList.add('hour-' + i);
                if (i == 0 || i == 6 || i == 12 || i == 18) {
                    mark.classList.add('sixth');
                }
                mark.textContent = '' + i;
                var angle = Utils.hour2angle(i);
                Utils.positionAt(mark, angle, 45);
                this.disc.appendChild(mark);
            }
        };
        Clock.prototype.updateTime = function () {
            var mmt = moment();
            var t = mmt.format('H:mm');
            if (t !== this.last_time) {
                this.last_time = t;
                var parts = t.split(':');
                document.getElementById('localtime').innerHTML = parts[0] + '<span id="loctimecolon">:</span>' + parts[1];
            }
            var s = (new Date()).getSeconds() % 2;
            document.getElementById('loctimecolon').style.visibility = s ? 'visible' : 'hidden';
        };
        Clock.prototype.updatePoints = function () {
            if (this.mouse_on_list) {
                console.log('Mouse over list, not redrawing.');
                return;
            }
            var x = document.querySelectorAll('.bullet, .person, .people-list');
            for (var i in x) {
                if (x.hasOwnProperty(i)) {
                    var e = x[i];
                    if (!e || !e.parentNode)
                        continue;
                    e.parentNode.removeChild(e);
                }
            }
            this.buildPoints();
        };
        Clock.prototype.buildPoints = function () {
            var _this = this;
            var resolved = [];
            this.profile.points.forEach(function (obj) {
                if (!obj._valid)
                    return;
                var t = TzResolver.getTimeForPoint(obj);
                obj._t = t;
                var placed;
                resolved.some(function (v) {
                    if (Math.abs(v.t - t) < 60) {
                        v.p.push(obj);
                        placed = true;
                        return true;
                    }
                });
                if (!placed) {
                    resolved.push({ t: t, p: [obj] });
                }
            });
            resolved.forEach(function (x) {
                _this.addPeopleAtTime(x.t, x.p);
            });
        };
        Clock.prototype.addPeopleAtTime = function (secs, people) {
            var _this = this;
            var i;
            var first = people[0];
            var t = secs / 3600;
            var angle = Utils.hour2angle(t);
            var octant = Math.floor(angle / 45);
            var quadrant = Math.floor(octant / 2);
            var is_up = (quadrant < 2);
            var is_left = (quadrant > 0 && quadrant < 3);
            var bu = document.createElement('div');
            bu.className = 'bullet';
            bu.style.backgroundColor = first.color;
            Utils.positionAt(bu, angle, 50.2);
            this.disc.appendChild(bu);
            var list = document.createElement('div');
            list.classList.add('people-list');
            list.classList.add(is_left ? 'left' : 'right');
            list.classList.add(is_up ? 'up' : 'down');
            list.classList.add('quad' + quadrant);
            list.classList.add('oct' + octant);
            var here = moment();
            var there = moment().tz(first._tz);
            i = Utils.mmtDayCompare(here, there);
            var clz = (i == -1) ? 'day-prev' : (i == 1) ? 'day-next' : null;
            if (clz !== null) {
                list.classList.add(clz);
                bu.classList.add(clz);
            }
            if (people.length > 1) {
                list.classList.add('multiple');
                list.classList.add('count-' + people.length);
            }
            for (i = 0; i < people.length; i++) {
                var peep = people[i];
                var child = this.createPointLabel(peep);
                child.title = there.format('H:mm, MMM Do') + ' — ' + peep._tz;
                list.appendChild(child);
            }
            list.addEventListener('mouseover', function () {
                _this.mouse_on_list = true;
            });
            list.addEventListener('mouseout', function () {
                _this.mouse_on_list = false;
            });
            Utils.positionAt(list, angle, 53.5, octant);
            this.disc.appendChild(list);
        };
        Clock.prototype.createPointLabel = function (obj) {
            var la;
            if (obj.name.indexOf('@') === 0) {
                la = document.createElement('a');
                la.href = 'https://twitter.com/' + obj.name;
                la.target = '_blank';
            }
            else {
                la = document.createElement('span');
            }
            la.classList.add('person-label');
            la.style.color = obj.color;
            la.textContent = obj.name;
            return la;
        };
        return Clock;
    })();
    Tzork.Clock = Clock;
})(Tzork || (Tzork = {}));
var Tzork;
(function (Tzork) {
    Tzork.theClock;
    Tzork.theRepo;
    function init(repo) {
        Tzork.theRepo = repo;
        Tzork.theClock = new Tzork.Clock();
        Tzork.theClock.loadActiveProfile();
    }
    Tzork.init = init;
})(Tzork || (Tzork = {}));
function main() {
    var repo = new Tzork.LocalRepository();
    repo.load();
    Tzork.init(repo);
}
//# sourceMappingURL=application.js.map